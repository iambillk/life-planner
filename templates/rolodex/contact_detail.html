{% extends "base.html" %}
{% block title %}{{ contact.display_name }} ¬∑ Rolodex{% endblock %}

{% block head %}
<style>
  .contact-detail-container * {
    box-sizing: border-box !important;
  }
  
  .detail-section {
    transition: transform 0.2s ease;
  }
  
  .detail-section:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  }
  
  .info-row {
    display: flex;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  }
  
  .info-row:last-child {
    border-bottom: none;
  }
  
  .info-label {
    flex: 0 0 150px;
    color: var(--text-muted);
    font-weight: 500;
  }
  
  .info-value {
    flex: 1;
    color: var(--text);
  }
  
  .info-value a {
    color: #3b82f6;
    text-decoration: none;
    transition: color 0.2s ease;
  }
  
  .info-value a:hover {
    color: #60a5fa;
    text-decoration: underline;
  }
  
  .tag-badge {
    display: inline-block;
    padding: 4px 12px;
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
    border-radius: 20px;
    font-size: 14px;
    margin-right: 8px;
    margin-bottom: 8px;
  }
  
  .empty-value {
    color: var(--text-muted);
    font-style: italic;
  }
  
  .photo-container {
    display: flex;
    gap: 20px;
    align-items: center;
  }
  
  .profile-photo-large {
    width: 150px;
    height: 150px;
    object-fit: cover;
    border-radius: 12px;
    border: 3px solid var(--line);
  }
  
  .business-card-photo {
    width: 200px;
    height: auto;
    border-radius: 8px;
    border: 2px solid var(--line);
    cursor: pointer;
    transition: transform 0.2s ease;
  }
  
  .business-card-photo:hover {
    transform: scale(1.05);
  }
</style>
{% endblock %}

{% block content %}
<div class="contact-detail-container" style="max-width: 1200px; margin: 0 auto; padding: 20px;">
  <!-- Header -->
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid var(--line);">
    <div style="display: flex; align-items: center; gap: 20px;">
      {% if contact.profile_photo %}
      <img src="{{ url_for('static', filename='contact_photos/' + contact.profile_photo) }}" 
           alt="{{ contact.display_name }}"
           class="profile-photo-large">
      {% else %}
      <div style="width: 150px; height: 150px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 48px; color: white; font-weight: bold;">
        {{ contact.display_name[0] | upper }}
      </div>
      {% endif %}
      
      <div>
        <h1 style="margin: 0; color: var(--text); font-size: 36px;">
          {{ contact.display_name }}
        </h1>
        {% if contact.title or contact.company %}
        <p style="margin: 8px 0 0 0; color: var(--text-muted); font-size: 18px;">
          {% if contact.title %}{{ contact.title }}{% endif %}
          {% if contact.title and contact.company %} at {% endif %}
          {% if contact.company %}{{ contact.company.name }}{% endif %}
        </p>
        {% endif %}
        {% if contact.tags %}
        <div style="margin-top: 12px;">
          {% for tag in contact.tags.split(',') %}
          <span class="tag-badge">{{ tag.strip() }}</span>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </div>
    
    <div style="display: flex; gap: 12px;">
      <a href="{{ url_for('rolodex.contact_edit', id=contact.id) }}" 
         style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: #3b82f6; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; transition: all 0.2s ease;"
         onmouseover="this.style.background='#2563eb'; this.style.transform='translateY(-1px)'"
         onmouseout="this.style.background='#3b82f6'; this.style.transform='translateY(0)'">
        ‚úèÔ∏è Edit
      </a>
      <form method="POST" action="{{ url_for('rolodex.contact_delete', id=contact.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this contact?');">
        <button type="submit"
                style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: #ef4444; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s ease;"
                onmouseover="this.style.background='#dc2626'; this.style.transform='translateY(-1px)'"
                onmouseout="this.style.background='#ef4444'; this.style.transform='translateY(0)'">
          üóëÔ∏è Delete
        </button>
      </form>
      <form method="POST" action="{{ url_for('rolodex.contact_archive', id=contact.id) }}" style="display: inline;">
        <button type="submit"
                style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: #6b7280; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s ease;"
                onmouseover="this.style.background='#4b5563'; this.style.transform='translateY(-1px)'"
                onmouseout="this.style.background='#6b7280'; this.style.transform='translateY(0)'">
          {% if contact.archived %}‚ôªÔ∏è Unarchive{% else %}üì¶ Archive{% endif %}
        </button>
      </form>
      <a href="{{ url_for('rolodex.contacts') }}" 
         style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: #374151; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; transition: all 0.2s ease;"
         onmouseover="this.style.background='#4b5563'; this.style.transform='translateY(-1px)'"
         onmouseout="this.style.background='#374151'; this.style.transform='translateY(0)'">
        ‚Üê Back
      </a>
    </div>
  </div>

  <!-- Archived Warning -->
  {% if contact.archived %}
  <div style="background: linear-gradient(135deg, #fbbf24, #f59e0b); color: #000; padding: 15px 20px; border-radius: 8px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
    <span style="font-size: 20px;">üì¶</span>
    <strong>This contact is archived.</strong> It won't appear in normal searches.
  </div>
  {% endif %}

  <!-- Business Card if exists -->
  {% if contact.business_card_photo %}
  <div class="detail-section" style="background: var(--card); border: 1px solid var(--line); border-radius: 12px; margin-bottom: 20px; overflow: hidden;">
    <h3 style="background: linear-gradient(135deg, rgba(110,168,255,0.1), transparent); padding: 16px 24px; margin: 0; border-bottom: 1px solid var(--line); font-size: 18px;">
      <span style="margin-right: 8px;">üíº</span>Business Card
    </h3>
    <div style="padding: 24px; text-align: center;">
      <img src="{{ url_for('static', filename='contact_photos/' + contact.business_card_photo) }}" 
           alt="Business Card"
           class="business-card-photo"
           onclick="window.open(this.src, '_blank')">
    </div>
  </div>
  {% endif %}

  <!-- Basic Information -->
  <div class="detail-section" style="background: var(--card); border: 1px solid var(--line); border-radius: 12px; margin-bottom: 20px; overflow: hidden;">
    <h3 style="background: linear-gradient(135deg, rgba(110,168,255,0.1), transparent); padding: 16px 24px; margin: 0; border-bottom: 1px solid var(--line); font-size: 18px;">
      <span style="margin-right: 8px;">üë§</span>Basic Information
    </h3>
    <div style="padding: 24px;">
      {% if contact.first_name or contact.last_name %}
      <div class="info-row">
        <div class="info-label">Full Name</div>
        <div class="info-value">
          {{ contact.first_name or '' }} {{ contact.last_name or '' }}
        </div>
      </div>
      {% endif %}
      
      <div class="info-row">
        <div class="info-label">Display Name</div>
        <div class="info-value">{{ contact.display_name }}</div>
      </div>
      
      {% if contact.title %}
      <div class="info-row">
        <div class="info-label">Title/Role</div>
        <div class="info-value">{{ contact.title }}</div>
      </div>
      {% endif %}
      
      {% if contact.company %}
      <div class="info-row">
        <div class="info-label">Company</div>
        <div class="info-value">
          <a href="{{ url_for('rolodex.company_detail', id=contact.company.id) }}">
            {{ contact.company.name }}
          </a>
        </div>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Contact Information -->
  {% if contact.email or contact.phone or contact.mobile_phone or contact.work_phone or contact.home_phone or contact.personal_email or contact.website %}
  <div class="detail-section" style="background: var(--card); border: 1px solid var(--line); border-radius: 12px; margin-bottom: 20px; overflow: hidden;">
    <h3 style="background: linear-gradient(135deg, rgba(110,168,255,0.1), transparent); padding: 16px 24px; margin: 0; border-bottom: 1px solid var(--line); font-size: 18px;">
      <span style="margin-right: 8px;">üìû</span>Contact Methods
    </h3>
    <div style="padding: 24px;">
      {% if contact.email %}
      <div class="info-row">
        <div class="info-label">üìß Primary Email</div>
        <div class="info-value">
          <a href="mailto:{{ contact.email }}">{{ contact.email }}</a>
        </div>
      </div>
      {% endif %}
      
      {% if contact.personal_email %}
      <div class="info-row">
        <div class="info-label">‚úâÔ∏è Personal Email</div>
        <div class="info-value">
          <a href="mailto:{{ contact.personal_email }}">{{ contact.personal_email }}</a>
        </div>
      </div>
      {% endif %}
      
      {% if contact.phone %}
      <div class="info-row">
        <div class="info-label">‚òéÔ∏è Primary Phone</div>
        <div class="info-value">
          <a href="tel:{{ contact.phone }}">{{ contact.phone }}</a>
        </div>
      </div>
      {% endif %}
      
      {% if contact.mobile_phone %}
      <div class="info-row">
        <div class="info-label">üì± Mobile Phone</div>
        <div class="info-value">
          <a href="tel:{{ contact.mobile_phone }}">{{ contact.mobile_phone }}</a>
        </div>
      </div>
      {% endif %}
      
      {% if contact.work_phone %}
      <div class="info-row">
        <div class="info-label">üíº Work Phone</div>
        <div class="info-value">
          <a href="tel:{{ contact.work_phone }}">{{ contact.work_phone }}</a>
        </div>
      </div>
      {% endif %}
      
      {% if contact.home_phone %}
      <div class="info-row">
        <div class="info-label">üè† Home Phone</div>
        <div class="info-value">
          <a href="tel:{{ contact.home_phone }}">{{ contact.home_phone }}</a>
        </div>
      </div>
      {% endif %}
      
      {% if contact.website %}
      <div class="info-row">
        <div class="info-label">üåê Website</div>
        <div class="info-value">
          <a href="{{ contact.website }}" target="_blank">{{ contact.website }}</a>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
  {% endif %}

  <!-- Physical Address -->
  {% if contact.street_address or contact.city or contact.state or contact.zip_code or contact.country %}
  <div class="detail-section" style="background: var(--card); border: 1px solid var(--line); border-radius: 12px; margin-bottom: 20px; overflow: hidden;">
    <h3 style="background: linear-gradient(135deg, rgba(110,168,255,0.1), transparent); padding: 16px 24px; margin: 0; border-bottom: 1px solid var(--line); font-size: 18px;">
      <span style="margin-right: 8px;">üìç</span>Physical Address
    </h3>
    <div style="padding: 24px;">
      <div class="info-row">
        <div class="info-label">Address</div>
        <div class="info-value">
          {% if contact.street_address %}
            {{ contact.street_address }}<br>
          {% endif %}
          {% if contact.address_line_2 %}
            {{ contact.address_line_2 }}<br>
          {% endif %}
          {% if contact.city or contact.state or contact.zip_code %}
            {{ contact.city }}{% if contact.city and contact.state %}, {% endif %}
            {{ contact.state }} {{ contact.zip_code }}<br>
          {% endif %}
          {% if contact.country %}
            {{ contact.country }}
          {% endif %}
          {% if not (contact.street_address or contact.city or contact.state or contact.zip_code or contact.country) %}
            <span class="empty-value">No address provided</span>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Social Media -->
  {% if contact.linkedin_url or contact.twitter_url or contact.facebook_url or contact.instagram_url or contact.github_url %}
  <div class="detail-section" style="background: var(--card); border: 1px solid var(--line); border-radius: 12px; margin-bottom: 20px; overflow: hidden;">
    <h3 style="background: linear-gradient(135deg, rgba(110,168,255,0.1), transparent); padding: 16px 24px; margin: 0; border-bottom: 1px solid var(--line); font-size: 18px;">
      <span style="margin-right: 8px;">üîó</span>Social Media
    </h3>
    <div style="padding: 24px;">
      {% if contact.linkedin_url %}
      <div class="info-row">
        <div class="info-label">üíº LinkedIn</div>
        <div class="info-value">
          <a href="{{ contact.linkedin_url }}" target="_blank">{{ contact.linkedin_url }}</a>
        </div>
      </div>
      {% endif %}
      
      {% if contact.twitter_url %}
      <div class="info-row">
        <div class="info-label">üê¶ Twitter/X</div>
        <div class="info-value">
          <a href="{{ contact.twitter_url }}" target="_blank">{{ contact.twitter_url }}</a>
        </div>
      </div>
      {% endif %}
      
      {% if contact.facebook_url %}
      <div class="info-row">
        <div class="info-label">üìò Facebook</div>
        <div class="info-value">
          <a href="{{ contact.facebook_url }}" target="_blank">{{ contact.facebook_url }}</a>
        </div>
      </div>
      {% endif %}
      
      {% if contact.instagram_url %}
      <div class="info-row">
        <div class="info-label">üì∑ Instagram</div>
        <div class="info-value">
          <a href="{{ contact.instagram_url }}" target="_blank">{{ contact.instagram_url }}</a>
        </div>
      </div>
      {% endif %}
      
      {% if contact.github_url %}
      <div class="info-row">
        <div class="info-label">üíª GitHub</div>
        <div class="info-value">
          <a href="{{ contact.github_url }}" target="_blank">{{ contact.github_url }}</a>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
  {% endif %}

  <!-- Personal Information -->
  {% if contact.birthday or contact.anniversary or contact.spouse_name or contact.children_names or contact.assistant_name %}
  <div class="detail-section" style="background: var(--card); border: 1px solid var(--line); border-radius: 12px; margin-bottom: 20px; overflow: hidden;">
    <h3 style="background: linear-gradient(135deg, rgba(110,168,255,0.1), transparent); padding: 16px 24px; margin: 0; border-bottom: 1px solid var(--line); font-size: 18px;">
      <span style="margin-right: 8px;">‚ù§Ô∏è</span>Personal Information
    </h3>
    <div style="padding: 24px;">
      {% if contact.birthday %}
      <div class="info-row">
        <div class="info-label">üéÇ Birthday</div>
        <div class="info-value">{{ contact.birthday.strftime('%B %d, %Y') }}</div>
      </div>
      {% endif %}
      
      {% if contact.anniversary %}
      <div class="info-row">
        <div class="info-label">üíç Anniversary</div>
        <div class="info-value">{{ contact.anniversary.strftime('%B %d, %Y') }}</div>
      </div>
      {% endif %}
      
      {% if contact.spouse_name %}
      <div class="info-row">
        <div class="info-label">üíë Spouse/Partner</div>
        <div class="info-value">{{ contact.spouse_name }}</div>
      </div>
      {% endif %}
      
      {% if contact.children_names %}
      <div class="info-row">
        <div class="info-label">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Children</div>
        <div class="info-value">{{ contact.children_names }}</div>
      </div>
      {% endif %}
      
      {% if contact.assistant_name %}
      <div class="info-row">
        <div class="info-label">üëî Assistant</div>
        <div class="info-value">{{ contact.assistant_name }}</div>
      </div>
      {% endif %}
    </div>
  </div>
  {% endif %}

  <!-- Notes -->
  {% if contact.notes %}
  <div class="detail-section" style="background: var(--card); border: 1px solid var(--line); border-radius: 12px; margin-bottom: 20px; overflow: hidden;">
    <h3 style="background: linear-gradient(135deg, rgba(110,168,255,0.1), transparent); padding: 16px 24px; margin: 0; border-bottom: 1px solid var(--line); font-size: 18px;">
      <span style="margin-right: 8px;">üìù</span>Notes
    </h3>
    <div style="padding: 24px;">
      <div style="white-space: pre-wrap; color: var(--text); line-height: 1.6;">{{ contact.notes }}</div>
    </div>
  </div>
  {% endif %}

  <!-- Metadata -->
  <div class="detail-section" style="background: var(--card); border: 1px solid var(--line); border-radius: 12px; overflow: hidden;">
    <h3 style="background: linear-gradient(135deg, rgba(110,168,255,0.1), transparent); padding: 16px 24px; margin: 0; border-bottom: 1px solid var(--line); font-size: 18px;">
      <span style="margin-right: 8px;">‚ÑπÔ∏è</span>Record Information
    </h3>
    <div style="padding: 24px;">
      <div class="info-row">
        <div class="info-label">Created</div>
        <div class="info-value">{{ contact.created_at.strftime('%B %d, %Y at %I:%M %p') if contact.created_at else 'Unknown' }}</div>
      </div>
      <div class="info-row">
        <div class="info-label">Last Updated</div>
        <div class="info-value">{{ contact.updated_at.strftime('%B %d, %Y at %I:%M %p') if contact.updated_at else 'Never' }}</div>
      </div>
    </div>
  </div>
</div>
{% endblock %}