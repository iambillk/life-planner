{% extends "base.html" %}

{% block title %}Add Consumable - {{ equipment.name }}{% endblock %}

{% block content %}
<div class="consumable-container">
    <div class="page-header">
        <h2>Add Consumable</h2>
        <p class="equipment-info">{{ equipment.year }} {{ equipment.make }} {{ equipment.model }}</p>
    </div>

    <form method="POST" action="{{ url_for('equipment.add_consumable', id=equipment.id) }}" enctype="multipart/form-data" class="consumable-form">
        
        <!-- Quick Select Section -->
        <div class="form-section">
            <h3>Quick Select</h3>
            <div class="quick-select-grid">
                <button type="button" class="quick-btn" onclick="setConsumableType('Engine Oil')">üõ¢Ô∏è Engine Oil</button>
                <button type="button" class="quick-btn" onclick="setConsumableType('Washer Fluid')">üíß Washer Fluid</button>
                <button type="button" class="quick-btn" onclick="setConsumableType('Wiper Blades')">üöø Wiper Blades</button>
                <button type="button" class="quick-btn" onclick="setConsumableType('Air Filter')">üå¨Ô∏è Air Filter</button>
                <button type="button" class="quick-btn" onclick="setConsumableType('Coolant')">üßä Coolant</button>
                <button type="button" class="quick-btn" onclick="setConsumableType('Brake Fluid')">üõë Brake Fluid</button>
                <button type="button" class="quick-btn" onclick="setConsumableType('Power Steering')">üîÑ Power Steering</button>
                <button type="button" class="quick-btn" onclick="setConsumableType('Transmission Fluid')">‚öôÔ∏è Trans Fluid</button>
            </div>
        </div>

        <!-- Item Details -->
        <div class="form-section">
            <h3>Item Details</h3>
            <div class="form-row">
                <div class="form-group">
                    <label for="item_type">Item Type*</label>
                    <input type="text" id="item_type" name="item_type" required 
                           placeholder="e.g., Engine Oil, Washer Fluid">
                </div>
                <div class="form-group">
                    <label for="brand">Brand</label>
                    <input type="text" id="brand" name="brand" 
                           placeholder="e.g., Mobil 1, Rain-X">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="quantity">Quantity*</label>
                    <input type="number" step="0.01" id="quantity" name="quantity" required
                           placeholder="1">
                </div>
                <div class="form-group">
                    <label for="unit">Unit*</label>
                    <select id="unit" name="unit" required>
                        <option value="">Select Unit</option>
                        <option value="quarts">Quarts</option>
                        <option value="gallons">Gallons</option>
                        <option value="liters">Liters</option>
                        <option value="ounces">Ounces</option>
                        <option value="each">Each (for items)</option>
                        <option value="pair">Pair (for wipers)</option>
                        <option value="set">Set</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Purchase Details -->
        <div class="form-section">
            <h3>Purchase Details</h3>
            <div class="form-row">
                <div class="form-group">
                    <label for="cost">Cost ($)*</label>
                    <input type="number" step="0.01" id="cost" name="cost" required
                           placeholder="0.00">
                </div>
                <div class="form-group">
                    <label for="vendor">Vendor/Store</label>
                    <input type="text" id="vendor" name="vendor"
                           placeholder="e.g., AutoZone, Walmart">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="date">Date*</label>
                    <input type="date" id="date" name="date" required
                           value="{{ today }}">
                </div>
                <div class="form-group">
                    <label for="odometer">Odometer (miles)</label>
                    <input type="number" id="odometer" name="odometer"
                           placeholder="{{ equipment.mileage or 'Current mileage' }}">
                </div>
            </div>
        </div>

        <!-- Additional Info -->
        <div class="form-section">
            <h3>Additional Information</h3>
            <div class="form-group">
                <label for="notes">Notes</label>
                <textarea id="notes" name="notes" rows="3"
                          placeholder="e.g., Top-off between oil changes, replaced both front wipers"></textarea>
            </div>
            
            <div class="form-group">
                <label for="receipt">Receipt Photo</label>
                <input type="file" id="receipt" name="receipt" accept="image/*">
                <small>Upload a photo of your receipt for record keeping</small>
            </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
            <a href="{{ url_for('equipment.detail', id=equipment.id) }}" class="btn btn-secondary">Cancel</a>
            <button type="submit" class="btn btn-primary">Save Consumable</button>
        </div>
    </form>
</div>

<script>
// Quick select functionality
function setConsumableType(type) {
    document.getElementById('item_type').value = type;
    
    // Auto-set common units based on type
    const unitMap = {
        'Engine Oil': 'quarts',
        'Washer Fluid': 'gallons',
        'Wiper Blades': 'pair',
        'Air Filter': 'each',
        'Coolant': 'gallons',
        'Brake Fluid': 'quarts',
        'Power Steering': 'quarts',
        'Transmission Fluid': 'quarts'
    };
    
    if (unitMap[type]) {
        document.getElementById('unit').value = unitMap[type];
    }
    
    // Visual feedback
    document.querySelectorAll('.quick-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
}

// Set today's date as default
document.addEventListener('DOMContentLoaded', function() {
    if (!document.getElementById('date').value) {
        document.getElementById('date').valueAsDate = new Date();
    }
});
</script>

<style>
.consumable-container {
    padding: 20px;
    max-width: 800px;
    margin: 0 auto;
}

.page-header {
    margin-bottom: 30px;
}

.page-header h2 {
    color: #2c3e50;
    margin-bottom: 5px;
}

.equipment-info {
    color: #7f8c8d;
    font-size: 14px;
}

.consumable-form {
    background: white;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.form-section {
    margin-bottom: 30px;
}

.form-section h3 {
    color: #2c3e50;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #ecf0f1;
}

/* Quick Select Grid */
.quick-select-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 10px;
    margin-bottom: 20px;
}

.quick-btn {
    padding: 12px 8px;
    background: #ecf0f1;
    border: 2px solid transparent;
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s;
    text-align: center;
}

.quick-btn:hover {
    background: #d5dbdd;
    transform: translateY(-2px);
}

.quick-btn.active {
    background: #3498db;
    color: white;
    border-color: #2980b9;
}

/* Form Elements */
.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    color: #2c3e50;
    font-weight: 500;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #3498db;
    box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
}

.form-group small {
    display: block;
    margin-top: 5px;
    color: #7f8c8d;
    font-size: 12px;
}

.form-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

/* Form Actions */
.form-actions {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
    padding-top: 20px;
    border-top: 1px solid #ecf0f1;
}

.btn {
    padding: 10px 20px;
    border-radius: 5px;
    text-decoration: none;
    border: none;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s;
}

.btn-primary {
    background: #3498db;
    color: white;
}

.btn-primary:hover {
    background: #2980b9;
}

.btn-secondary {
    background: #95a5a6;
    color: white;
}

.btn-secondary:hover {
    background: #7f8c8d;
}

/* Responsive */
@media (max-width: 600px) {
    .consumable-form {
        padding: 20px;
    }
    
    .quick-select-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}